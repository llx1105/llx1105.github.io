---
layout: post
title: network security
category: 技术
tags: tech
keywords: security
---

简单地学习了一下network security方面相关的知识。

# XSS

[点我](http://xss-game.appspot.com/)有个xss的game小网站。

### XSS 是什么？

  跨站脚本攻击(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS。简单的说xss攻击就是指恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意攻击用户的特殊目的。

### XSS 的分类

xss漏洞表现为各种形式，而且主要可以分为三种类型：反射型、保存型和基于DOM的XSS漏洞。

### 反射型xss漏洞(也叫非持久性XSS)

  发出请求时，XSS代码出现在URL中，作为输入提交到服务端，服务端解析后响应，在响应内容中出现这段XSS代码，最后浏览器解析执行。这个过程就像一次反射，故称为反射型XSS。


### 保存型xss漏洞(也叫持久性XSS)

  保存型xss漏洞意思是用户A提交的数据没有经过过滤，就保存在web程序中（通常是数据库中），然后直接展示给其他用户。 这样如果数据中有恶意的代码，就会在用户的浏览器中直接执行。

  其中一个典型的例子就是留言板XSS，用户提交一条包含XSS代码的留言存储到数据库，目标用户查看留言板时，那些留言的内容会从数据库查询出来并显示，浏览器发现有XSS代码，就当做正常的HTML与JS解析执行，于是就出发了XSS攻击。

### 基于DOM的xss漏洞

反射型和保存型XSS漏洞都表现出一种特殊的行为模式，其中应用程序提取用户控制的数据并以危险的方式将这些数据返回给用户。第三类XSS漏洞并不具有这些特点。

### 有何危害

* 挂马
* 盗取用户cookie
* Dos(拒绝服务)客户端浏览器
* 钓鱼攻击，高级钓鱼技巧
* 编写针对性的XSS病毒，删除目标文章、恶意篡改数据
* 劫持用户Web行为，甚至进一步渗透内网。
* 爆发Web 2.0蠕虫。
* 蠕虫DDos攻击。
* 蠕虫式挂马攻击、刷广告、刷流量、破坏网上数据。

### 预防xss攻击

防止xss需要将不可信数据与动态的浏览器内容区分开

1 最好的办法是根据数据将要置于的HTML上下文（包括主体、属性、Javascript、css或URL）对所有的不可信数据进行恰当的转义（escape）。

2 使用这面的或“白名单”的，具有恰当的规范化和解码功能的输入验证方法同样会有助于防止跨站脚本 。但由于很多应用程序在输入中需要特殊字符，这一方法不是完整的防护方法。这种验证方法需要尽可能地解码任何编码输入，同时在接受输入之前需要充分验证数据的长度、字符、格式、和任何商务规则。

3 考虑使用内容安全策略来抵御整个网站的跨站脚本攻击。


# CSRF

### CSRF 是什么？

  跨站请求伪造(Cross Site Request Forgery),CSRF是利用某些web应用程序允许攻击者预测一个特定操作的所有细节这一特点。 由于浏览器自动发送会话cookie等认证凭证，攻击者能创建恶意web页面产生伪造请求。这些伪造请求很难与合法请求区分开。跨站请求伪造漏洞可以很容易通过渗透测试或代码分析测试到。

### 如何防止CSRF

  防止跨站请求伪造，通常需要在每个HTTP请求中添加一个不可预测的令牌。这种令牌至少应该对每一个用户会话来说是唯一的。

  1. 最好的办法是将独有的令牌包含在一个隐藏字段中。这将使得该令牌通过HTTP请求体发送，避免其包含在url中从而被暴露出来。

  2. 该独有令牌同样可以包含在URL中火作为一个URL参数。但是这种方法的巨大风险在于： URL 会暴露给攻击者，这样秘密令牌也会被泄露。
  OWASP的CSRF Guard可以用来在Java EE, .NET, or PHP应用程序中自动加入这种令牌。OWASP的ESAPI包含了多种开发者可以使用的方法来防止CSRF漏洞。

  3. 要求用户重新认证或者判明他们是一个真实的用户(例如通过CAPTCHA)也可以防护CSRF攻击。
